# 用例执行的先后顺序
先看普通函数运行顺序
```python
import pytest

def test_one():
    print("我是清安")

def test_02():
    print("--02--")

def test_a():
    print("--a--")

def test_a_1():
    print("--a_01__")

def test_01():
    print("--01--")
```
![image.png](https://cdn.nlark.com/yuque/0/2022/png/25452484/1670819981745-1b4968fe-14ea-4ba2-a5ef-a4e7e8cd7f1f.png#averageHue=%23fcfcfb&clientId=u087a934a-06d7-4&from=paste&height=306&id=u690f647e&name=image.png&originHeight=382&originWidth=1054&originalType=binary&ratio=1&rotation=0&showTitle=false&size=38492&status=done&style=none&taskId=u8e407336-0d95-4213-8dfa-dc64eec4fb9&title=&width=843.2)
可以看到，这样写，用例的运行先后顺序根据自己写的先后函数顺序进行执行的。
那么写到类中呢？
```python
import pytest

class Testcase:
    def test_one(self):
        print("我是清安")

    def test2(self):
        print("--02--")

    def test_a(self):
        print("--a--")

    def test_a_1(self):
        print("--a_01__")

    def test1(self):
        print("--01--")
```
![image.png](https://cdn.nlark.com/yuque/0/2022/png/25452484/1670835657318-82f3b52d-62c8-47d3-b0da-f5144473e7ac.png#averageHue=%23fcfcfb&clientId=uc3421dec-32cd-4&from=paste&height=288&id=u22816685&name=image.png&originHeight=360&originWidth=795&originalType=binary&ratio=1&rotation=0&showTitle=false&size=30247&status=done&style=none&taskId=uc276e3e0-ee9a-4b5f-95a1-8aa43e46676&title=&width=636)
没有丝毫变化。
## 模块用例运行先后顺序
首先准备两个.py文件，名称为test_a,test_b。内容如下：
```python
import pytest

class Test_a:
    def test_a1(self):
        print(f"我是-{__class__.__name__}-类")
```
```python
import pytest

class Test_b:
    def test_b1(self):
        print(f"我是-{__class__.__name__}-类")
```
![image.png](https://cdn.nlark.com/yuque/0/2022/png/25452484/1670911028617-f8206c58-23df-436b-8fd1-12c29f2e2046.png#averageHue=%23fcfcfb&clientId=u37dfe069-ab0a-4&from=paste&height=310&id=u39165324&name=image.png&originHeight=387&originWidth=1023&originalType=binary&ratio=1&rotation=0&showTitle=false&size=38049&status=done&style=none&taskId=ua8b42d5d-f819-475e-acc8-9c045fb0a0a&title=&width=818.4)
看，是有先后顺序的。其实你也可以理解为是Pycharm已经事先排过一次顺序了，按a-z亦或者1-9这样的顺序已经排过了，因为，你在创建.py文件的时候，就已经产生了顺序，pytest只是按照特定顺序进行测试而已。
# 前置后置
```python
import pytest

class Testcase():
    def setup(self):
        """每个方法用例运行前运行"""
        print("---1-set---")

    def teardown(self):
        """每个方法用例运行后运行"""
        print("---1-down---")

    def setup_class(self):
        """每个 class 运行前运行(只运行一次)"""
        print("---2-set class---")

    def teardown_class(self):
        """每个 class 运行后运行(只运行一次)"""
        print("---2-down class---")

    def test_02(self):
        print("--02--")

    def test_01(self):
        print("--01--")
```
![image.png](https://cdn.nlark.com/yuque/0/2022/png/25452484/1670836819553-0e8492a9-81c2-40ca-8445-7053a4d32b25.png#averageHue=%23fdfbf7&clientId=uc3421dec-32cd-4&from=paste&height=179&id=uf2ca84d1&name=image.png&originHeight=224&originWidth=1008&originalType=binary&ratio=1&rotation=0&showTitle=false&size=30623&status=done&style=none&taskId=u60a74355-588b-4af7-9852-c186c15260b&title=&width=806.4)
它会告诉你teardowm在后续准备取消了，建议改用teardowm_method，改完后再跑，就不会出现这种警告了。(**setup改setup_method以及teardowm改teardowm_method此处需自己改动**)
![image.png](https://cdn.nlark.com/yuque/0/2022/png/25452484/1670837579111-ab68b492-aa4e-4a96-8364-3df67cf3faee.png#averageHue=%23fdfdfc&clientId=u8b4027b0-e39a-4&from=paste&height=267&id=ub17e67cf&name=image.png&originHeight=334&originWidth=859&originalType=binary&ratio=1&rotation=0&showTitle=false&size=21446&status=done&style=none&taskId=u8786f66e-f928-4f35-8749-923a605fb1f&title=&width=687.2)
 前置后置是不计入用例的，它只会默默的奔跑  。并且它不会像unittest一样根据用例的名称来自动判断执行用例的先后顺序。它有自己的方式方法。
> 💥注意看优先级，以及代码中的注释，setup_class先运行，并且直到代码全部跑完，teardown_class才运行，其中setup_method以及teardowm_method每个用例运行的时候前后都会运行一次。

# 用例先后顺序设定pytest-ordering
这就需要用到第三方插件了
```python
pip install pytest-ordering
```
```python
import pytest

class Testcase():
    def setup_method(self):
        """每个方法用例运行前运行"""
        print("---1-set---")

    def teardown_method(self):
        """每个方法用例运行后运行"""
        print("---1-down---")

    def setup_class(self):
        """每个 class 运行前运行(只运行一次)"""
        print("---2-set class---")

    def teardown_class(self):
        """每个 class 运行后运行(只运行一次)"""
        print("---2-down class---")

    def setup_module(self):
        """模块运行前运行(只运行一次)"""
        print("---3-module class---")

    def teardown_module(self):
        """模块运行后运行(只运行一次)"""
        print("---3-module class---")
        
    @pytest.mark.run(order=2)
    def test_02(self):
        print("--02--")

    @pytest.mark.run(order=1)
    def test_01(self):
        print("--01--")
```
![image.png](https://cdn.nlark.com/yuque/0/2022/png/25452484/1670896738248-4c8da4f8-3e33-4203-934d-c45a74a88869.png#averageHue=%23fdfdfc&clientId=u7a73c10d-3251-4&from=paste&height=262&id=u023b7275&name=image.png&originHeight=328&originWidth=697&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20296&status=done&style=none&taskId=ub51d1e26-7b7b-47cf-9b39-0863d8c7b6a&title=&width=557.6)
如上简单的小测试，以便于了解。接下来详细说说！
## 源码小片段
```python
orders_map = {
    'first': 0,
    'second': 1,
    'third': 2,
    'fourth': 3,
    'fifth': 4,
    'sixth': 5,
    'seventh': 6,
    'eighth': 7,
    'last': -1,
    'second_to_last': -2,
    'third_to_last': -3,
    'fourth_to_last': -4,
    'fifth_to_last': -5,
    'sixth_to_last': -6,
    'seventh_to_last': -7,
    'eighth_to_last': -8,
}
```
> 上述是源码中对于优先级

## 一个小示范
```python
import pytest

class Testnew:

    @pytest.mark.second
    def testa_02(self):
        print("--02--")

    @pytest.mark.third
    def testa_03(self):
        print("--03--")

    @pytest.mark.fourth
    def testa_04(self):
        print("--04--")

    @pytest.mark.first
    def testa_01(self):
        print("--01--")
```
![image.png](https://cdn.nlark.com/yuque/0/2022/png/25452484/1670898734736-1f729ac9-3ad0-43ab-9f8e-03d335a19512.png#averageHue=%23fcfcfb&clientId=u951f253f-7d88-4&from=paste&height=349&id=ue9319260&name=image.png&originHeight=436&originWidth=1031&originalType=binary&ratio=1&rotation=0&showTitle=false&size=44614&status=done&style=none&taskId=u7628d83f-b2bd-4af2-9493-fe1343779a2&title=&width=824.8)
> 鉴于上述，运行的时候会提示一系列的信息(此处不展示)，看着不爽，可以：

```python
import pytest


class Testnew:

    @pytest.mark.run(order=2)
    def testa_02(self):
        print("--02--")

    @pytest.mark.run(order=3)
    def testa_03(self):
        print("--03--")

    @pytest.mark.run(order=4)
    def testa_04(self):
        print("--04--")

    @pytest.mark.run(order=1)
    def testa_01(self):
        print("--01--")
```
![image.png](https://cdn.nlark.com/yuque/0/2022/png/25452484/1670899644701-d77ffb58-d0fd-46b9-b8da-a72c563e53b8.png#averageHue=%23fdfcfc&clientId=u951f253f-7d88-4&from=paste&height=202&id=u12b4869e&name=image.png&originHeight=253&originWidth=925&originalType=binary&ratio=1&rotation=0&showTitle=false&size=19823&status=done&style=none&taskId=ua8f421bf-5526-41e2-9327-04d58be880a&title=&width=740)
当然上述代码中你也可以写入负数，也是可以的。
# 执行特定的用例
也就是前面讲过的-k参数。一起看看
```python
import pytest

class Test_new:
    def test_b2(self):
        print("**b2**")

    def test_b1(self):
        print("**b1**")

    def test_a1(self):
        print("--a1--")

    def test_a2(self):
        print("--a2--")
```
![image.png](https://cdn.nlark.com/yuque/0/2022/png/25452484/1670914113132-58106cf6-42e1-4ff2-8299-f131676ba29a.png#averageHue=%23fcfbfa&clientId=u34e1a41f-5922-4&from=paste&height=307&id=u0007b23c&name=image.png&originHeight=384&originWidth=1018&originalType=binary&ratio=1&rotation=0&showTitle=false&size=41765&status=done&style=none&taskId=u5e2af11e-8579-45a1-8893-357b796ca2e&title=&width=814.4)
它可以帮助我们过滤掉一些不想运行的用例，也是一个很不错且比较常用的参数。
